<!-- src/main/resources/templates/lecture/form.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title th:text="${lectureFormDto.lectureId == null ? '강의 등록' : '강의 수정'}"></title>
    <style>
        body { background: #f6f7fb; margin:0; font-family: 'Apple SD Gothic Neo', '맑은 고딕', Arial, sans-serif; }
        .form-container { max-width:560px; margin:65px auto; background:#fff; border-radius:14px; box-shadow:0 8px 36px #e3e7f6; padding:42px 38px;}
        h2 { color:#2b3777; text-align:center; margin-bottom:27px;}
        .form-group { margin-bottom: 23px; }
        label { font-weight: bold; color: #273064; margin-bottom: 7px; display: block;}
        input[type="text"], input[type="number"], select, textarea {
            width: 100%; border: 1.5px solid #e3e4ed; border-radius: 8px; padding: 12px 13px; font-size: 1.05em; margin-top: 5px;
            background: #f9faff; transition: border 0.2s;
        }
        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus { border: 2px solid #38499a; outline:none;}
        textarea { min-height: 90px; resize: vertical;}
        select { background: #f9faff;}
        .filebox { margin-top: 7px; }
        .img-preview-list { display: flex; gap:8px; margin-top: 7px;}
        .img-preview { border: 1px solid #eee; border-radius: 7px; max-width: 64px; max-height:64px;}
        .btns { margin-top: 34px; text-align: center; }
        .btn { display: inline-block; padding: 10px 33px; background: #2978f0; color: #fff; border-radius: 7px; border: none; font-weight: bold; margin-right: 15px; font-size: 1.08em; cursor: pointer;}
        .btn.cancel { background: #bfc6d7; color: #233;}
        .btn:hover { background: #153573;}
    </style>
    <script>
    function previewThumbnails(input) {
        const preview = document.getElementById('thumbPreviews');
        preview.innerHTML = '';
        Array.from(input.files).forEach(file => {
            const reader = new FileReader();
            reader.onload = e => {
                const img = document.createElement('img');
                img.src = e.target.result;
                img.className = 'img-preview';
                preview.appendChild(img);
            };
            reader.readAsDataURL(file);
        });
    }
    </script>
</head>
<body>
<div class="form-container" layout:fragment="content">
    <h2 th:text="${lectureFormDto.lectureId == null ? '강의 등록' : '강의 수정'}"></h2>
    <form th:action="@{/lecture/save}" th:object="${lectureFormDto}" method="post" enctype="multipart/form-data">
        <input type="hidden" th:field="*{lectureId}" />
        <div class="form-group">
            <label>제목</label>
            <input type="text" th:field="*{title}" required autocomplete="off"/>
        </div>
        <div class="form-group">
            <label>설명</label>
            <textarea th:field="*{description}" required></textarea>
        </div>
        <div class="form-group">
            <label>카테고리</label>
            <input type="text" th:field="*{category}" placeholder="예: 프로그래밍, 디자인 등"/>
        </div>
        <div class="form-group">
            <label>가격</label>
            <input type="number" th:field="*{price}" min="0" placeholder="0은 무료"/>
        </div>
        <div class="form-group">
            <label>상태</label>
            <select th:field="*{lectureStatus}">
                <option th:each="stat : ${statusList}"
                        th:value="${stat.name()}"
                        th:text="${stat.name()}"
                        th:selected="${stat.name() == lectureFormDto.status}">
                </option>
            </select>
        </div>
        <div class="form-group">
            <label>강사</label>
            <select th:field="*{instructorId}">
                <option value="" disabled th:if="*{instructorId == null}" selected>-- 강사 선택 --</option>
                <option th:each="inst : ${instructorList}"
                        th:value="${inst.memberId}"
                        th:text="${inst.name}"
                        th:selected="${inst.memberId == lectureFormDto.instructorId}">
                </option>
            </select>
        </div>
        <div class="form-group filebox">
            <label>썸네일 이미지 (여러 개 선택 가능)</label>
            <input type="file" name="thumbnailFiles" id="thumbnailFiles" accept="image/*" multiple
                   onchange="previewThumbnails(this)"/>
            <div id="thumbPreviews" class="img-preview-list"></div>
            <div th:if="*{thumbnailPath != null}">
                <img th:src="@{${lectureFormDto.thumbnailPath}}" alt="썸네일" width="60" class="img-preview"/>
            </div>
        </div>
        <div class="btns">
            <button type="submit" class="btn">저장</button>
            <a th:href="@{/lecture/list}" class="btn cancel">목록</a>
        </div>
    </form>
</div>
</body>
</html>
